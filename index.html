<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verificador de CEP e √Årea de Atendimento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Define a fonte Inter (padr√£o) e aplica um fundo legal */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f7fafc;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }

      .botao-link-padrao {
        /* Layout e Largura */
        display: inline-block; /* Comporta-se como bloco, mas em linha */
        text-align: center;
        width: 120px;
        padding: 0.5rem 1.5rem
        max-width: 320px; /* Equivalente a max-w-xs */
        display: block;
        margin: 0 auto;
        text-align: center;
        
        /* Cores e Fundo (Gray 200) */
        background-color: #A8E6B2; /* cor do bot√£o prosseguir*/
        color: #004509; /* text-gray-700 */

        /* Espa√ßamento e Borda */
        padding: 1rem; /* p-4 */
        border-radius: 0.75rem; /* rounded-xl */

        /* Fonte e Sombra */
        font-weight: 700; /* font-bold */
        font-size: 1.125rem; /* text-lg */
        box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1),
          0 2px 4px -2px rgb(0 0 0 / 0.1); /* shadow-md */

        /* Transi√ß√µes (para efeitos de hover) */
        transition-property: all; /* transition */
        transition-duration: 300ms; /* duration-300 */
        transition-timing-function: cubic-bezier(
          0.4,
          0,
          0.2,
          1
        ); /* ease-in-out */
      }

      /* Estilos de Intera√ß√£o (Hover e Active) */
      .botao-link-padrao:hover {
        background-color: rgb(209 213 219); /* hover:bg-gray-300 */
      }

      .botao-link-padrao:active {
        transform: scale(0.95); /* active:scale-95 */
      }


      
    /* CSS para garantir que a dupla fique na mesma linha */
.cep-ajuda {
    /* Exibe os elementos filhos lado a lado */
    display: flex; 
    
    /* Alinha verticalmente no centro (opcional, mas bom) */
    align-items: center; 
    
    /* Adiciona um pequeno espa√ßo abaixo do input */
    margin-top: 5px; 
    
    /* Garante que o texto comece √† esquerda do cont√™iner */
    width: 100%;
}

.cep-label {
    /* Garante um pequeno espa√ßo entre o texto e o bot√£o */
    margin-right: 5px; 
    
    /* Estilo de fonte para o texto auxiliar */
    font-size: 0.9em; 
}

/* Estilos do bot√£o/link para ficar como na sua imagem */
.buscar-cep-link {
    /* Remove sublinhado */
    text-decoration: none; 
    
    /* Garante que o padding funcione */
    display: inline-block; 
    
    /* Cores e padding para o visual de "bot√£o pequeno" */
    background-color: #5c6bc0; /* Azul do seu bot√£o */
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 0.7em;
    font-weight: bold;
}
    .img-mapa {
      display: flex;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: block; /* Transforma a imagem em bloco */
    margin-left: auto;
    margin-right: auto;
    /* Shorthand: */
    margin: 0 auto;  
    }
/*---__Bot√£o X__--------------------*/
    /* Estiliza√ß√£o b√°sica do bot√£o */
.botao-X {
    /* Define o tamanho e margem */
    background-color: #453ae1;
    color: red;
    
    /* REMOVA: padding: 0.1rem 1.2rem; */ 
    
    border-radius: 50%;
    
    /* DEIXE A LARGURA E ALTURA IGUAIS para formar um c√≠rculo */
    width: 30px; 
    height: 30px; /* Adicione altura igual √† largura */
    
    box-shadow: 0 5px 10px rgba(0, 10, 0, 0.2); /* Sombra mais suave */
    font-size: 20px;
    
    /* Aplica a anima√ß√£o principal */
    /* Propriedades:
    1. nome-da-animacao (piscar)
    2. dura√ß√£o (1s)
    3. fun√ß√£o de tempo (ease-in-out para um piscar suave)
    4. contagem de repeti√ß√µes (infinite para piscar sem parar)
    5. dire√ß√£o (alternate - opcional, garante que o piscar seja suave)
    */
    animation: piscar 1s ease-in-out infinite alternate;
}

/* Define a anima√ß√£o "piscar" usando keyframes 
0% e 100% s√£o o in√≠cio e o fim do ciclo de anima√ß√£o.
*/
@keyframes piscar {
    /* Estado inicial (0% do ciclo de anima√ß√£o) */
    0% {
        background-color: #ff0000; /* Vermelho vibrante */
        opacity: 1; /* Totalmente vis√≠vel */
    }

    /* Ponto intermedi√°rio (50% do ciclo de anima√ß√£o) */
    50% {
        background-color: #000000; /* Preto */
        opacity: 0.7; /* Ligeiramente transparente para dar efeito de "piscar" */
    }

    /* Estado final (100% do ciclo de anima√ß√£o) */
    100% {
        background-color: #ff0000; /* Volta para vermelho */
        opacity: 1; /* Totalmente vis√≠vel */
    }
}



      
      
    </style>
  </head>
  <body>
    <div class="w-full max-w-md bg-white p-6 sm:p-8 rounded-2xl shadow-xl border border-gray-100">
      
      <img class="img-mapa" src="https://static.vecteezy.com/system/resources/previews/017/396/764/non_2x/google-maps-icon-free-png.png" alt="Sabor de Casa Logo">
        
      <br>
      <h1 class="text-3xl font-extrabold text-indigo-700 mb-3 text-center">
        üìç Onde voc√™ est√°? üìç
      </h1>
      <p class="text-gray-600 mb-6 text-center">
        Digite seu CEP para verificar a √°rea de atendimento e poss√≠veis ofertas.
      </p>

      <div class="space-y-4">
        <input
          id="inputCep"
          type="text"
          placeholder="Ex: 75000-000"
          maxlength="9"
          class="w-full p-3 border-2 border-indigo-300 rounded-xl focus:border-indigo-500 focus:ring-indigo-500 outline-none transition duration-150 text-center text-lg font-mono"
          oninput="formatarCEP(this)"/>

        <a class="botao-X" href="loja.html">X</a>


<div class="cep-ajuda">
    <span class="cep-label">N√£o sei meu CEP::</span>
    <a href="buscarCEP.html" class="buscar-cep-link">Ver meu CEP</a>
</div>
  
        

        <button
          id="botaoVerificar"
          onclick="verificarCEP()"
          class="w-full bg-indigo-600 text-white p-3 rounded-xl font-bold text-lg hover:bg-indigo-700 transition duration-300 shadow-md shadow-indigo-300 active:scale-95 disabled:bg-indigo-400"
        >
          Verificar Atendimento
        </button>
      </div>
     
      <div
        id="mensagemResultado"
        class="mt-8 p-5 min-h-[120px] bg-indigo-50 border-l-4 border-indigo-500 rounded-lg text-gray-800 transition-all duration-500 flex items-center justify-center text-center text-base font-semibold">
        <p>Sua mensagem de resultado aparecer√° aqui.</p>
      </div>

      <div id="indicadorCarregamento" class="hidden mt-4 text-center">
        <svg
          class="animate-spin h-5 w-5 text-indigo-600 mx-auto"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle
            class="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            stroke-width="4"
          ></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
        <p class="text-sm text-indigo-600 mt-2">Buscando endere√ßo...</p>
      </div>

      <br /><br />
      <!-- O link "Confirmar" √© ocultado por padr√£o e s√≥ √© exibido se o CEP for atendido -->
      <a id="linkConfirmar" class="botao-link-padrao hidden" href="loja.html">
        <strong>Prosseguir</strong>
      </a>
<br><br>
    

    </div>

    <script>
      // Fun√ß√£o para formatar o CEP (adiciona o h√≠fen)
      function formatarCEP(input) {
        let valor = input.value.replace(/\D/g, ''); // Remove tudo que n√£o √© d√≠gito
        if (valor.length > 5) {
          valor = valor.substring(0, 5) + '-' + valor.substring(5, 8);
        }
        input.value = valor;
      }

      // Vari√°vel para evitar m√∫ltiplos cliques enquanto busca a API
      let estaBuscando = false;

      async function verificarCEP() {
        if (estaBuscando) return;

        const inputCep = document.getElementById('inputCep');
        const mensagemResultado = document.getElementById('mensagemResultado');
        const indicadorCarregamento = document.getElementById('indicadorCarregamento');
        const botaoVerificar = document.getElementById('botaoVerificar');
        const linkConfirmar = document.getElementById('linkConfirmar');

        const cep = inputCep.value.replace(/\D/g, ''); // Limpa o CEP (somente d√≠gitos)

        // 0. Esconde o link de confirma√ß√£o no in√≠cio de cada busca
        linkConfirmar.classList.add('hidden');

        // 1. Valida√ß√£o b√°sica do CEP
        if (cep.length !== 8) {
          mensagemResultado.innerHTML = `<p class="text-red-600">Por favor, digite um CEP v√°lido com 8 d√≠gitos.</p>`;
          mensagemResultado.classList.remove('border-indigo-500', 'bg-indigo-50', 'border-green-500', 'bg-green-50');
          mensagemResultado.classList.add('border-red-500', 'bg-red-50');
          return;
        }

        // Configura√ß√µes de UI durante a busca
        estaBuscando = true;
        botaoVerificar.disabled = true;
        botaoVerificar.textContent = 'Verificando...';
        indicadorCarregamento.classList.remove('hidden');
        mensagemResultado.classList.remove('border-indigo-500', 'bg-indigo-50', 'border-red-500', 'bg-red-50', 'border-green-500', 'bg-green-50');
        mensagemResultado.innerHTML = `<p class="text-gray-500">Buscando informa√ß√µes do endere√ßo...</p>`;

        // L√≥gica de backoff para a API (Tenta 3 vezes em caso de falha de conex√£o)
        const maxTentativas = 3;
        let tentativaAtual = 0;
        let dadosApi = null;
        let isConnectionError = false; // Flag para diferenciar erro de conex√£o de CEP n√£o encontrado

        while (tentativaAtual < maxTentativas) {
          try {
            // API ViaCEP
            const urlApi = `https://viacep.com.br/ws/${cep}/json/`;
            const resposta = await fetch(urlApi);

            if (!resposta.ok) {
              // Erro HTTP (404, 500 etc)
              throw new Error(`Erro HTTP: ${resposta.status}`);
            }

            const dados = await resposta.json();

            // ViaCEP retorna { erro: true } para CEPs que n√£o existem, mas a conex√£o foi bem-sucedida.
            if (dados.erro) {
              dadosApi = dados; 
              isConnectionError = false; // N√£o √© erro de conex√£o
              break;
            }

            dadosApi = dados;
            isConnectionError = false;
            break; // Sai do loop se a busca for bem-sucedida

          } catch (erro) {
            // Este bloco captura erros de rede/conex√£o (API fora do ar, CORS, etc.)
            isConnectionError = true;
            tentativaAtual++;
            if (tentativaAtual < maxTentativas) {
              // Espera (1s, 2s, 4s) antes de tentar novamente (Exponential Backoff)
              const atraso = Math.pow(2, tentativaAtual) * 1000;
              await new Promise(resolve => setTimeout(resolve, atraso));
            }
          }
        }

        // Restaura as configura√ß√µes de UI
        estaBuscando = false;
        botaoVerificar.disabled = false;
        botaoVerificar.textContent = 'Verificar Atendimento';
        indicadorCarregamento.classList.add('hidden');

        // 2. Processamento da Resposta
        let mensagem = '';
        let classesEstilo = '';
        let canProceed = false;
        





        // Define as cidades que recebem o tratamento de "Servi√ßos de Barman"
        const cidadesBarman = ['goi√¢nia', 'piren√≥polis', 'abadi√¢nia']; // Adicione mais cidades aqui, sempre em min√∫sculas
        // Adicione mais cidades aqui, sempre em min√∫sculas
        // Adicione mais cidades aqui, sempre em min√∫sculas
        // Adicione mais cidades aqui, sempre em min√∫sculas





        if (isConnectionError && dadosApi === null) {
             // Caso de falha total na conex√£o ap√≥s todas as tentativas
             const cepFormatado = cep.length === 8 ? `${cep.substring(0, 5)}-${cep.substring(5, 8)}` : cep;
             mensagem = `‚ùå Erro de Conex√£o. N√£o foi poss√≠vel buscar o CEP ${cepFormatado} ap√≥s ${maxTentativas} tentativas. Por favor, verifique sua conex√£o com a internet ou tente novamente mais tarde.`;
             classesEstilo = 'border-red-500 bg-red-50 text-red-800';
             canProceed = false;

             // Exibe a mensagem de erro de conex√£o
             mensagemResultado.innerHTML = `<p class="text-base text-current font-bold">${mensagem}</p>`;
        } else {
            // Extrai e normaliza os dados para compara√ß√£o
            const logradouro = dadosApi?.logradouro || 'Endere√ßo n√£o encontrado';
            const estado = dadosApi?.uf?.toUpperCase() || '';
            const cidade = dadosApi?.localidade?.toLowerCase() || '';
            const bairro = dadosApi?.bairro?.toLowerCase() || ''; // Bairro em min√∫sculas para compara√ß√£o

            // Monta o endere√ßo de forma mais amig√°vel
            const enderecoCompleto = `${logradouro}${dadosApi?.bairro ? ', ' + dadosApi.bairro : ''} - ${dadosApi?.localidade} / ${estado}`;

            if (dadosApi.erro || cidade === '' || estado === '') {
              // Caso a API retorne erro (CEP inexistente/dados vazios).
              // Isso inclui o CEP geral de cidade que muitas vezes n√£o retorna o nome da cidade.
              const cepFormatado = cep.length === 8 ? `${cep.substring(0, 5)}-${cep.substring(5, 8)}` : cep;

              mensagem = `üòî Sentimos muito, mas o CEP ${cepFormatado} est√° fora da nossa √°rea de entrega ou n√£o existe. 
                          Se voc√™ est√° em uma cidade atendida, tente digitar um CEP mais espec√≠fico (de uma rua, n√£o o CEP geral).
                          ü•∞ O convite est√° de p√©: d√™ uma olhada no nosso site e planeje uma visita a An√°polis-GO!
                          Teremos o prazer de preparar um drink exclusivo para voc√™ saborear conosco.`;
              classesEstilo = 'border-red-500 bg-red-50 text-red-800';
              canProceed = false;
            } else if (cidadesBarman.includes(cidade) && estado === 'GO') {
              // REGRA 1: Cidades Barman (Goi√¢nia, Piren√≥polis, Abadi√¢nia)
              mensagem = `üçπAtendemos a regi√£o de ${dadosApi.localidade} (GO) para servi√ßos de Barman
               em Festas, Anivers√°rios, Confraterniza√ß√µes, etc.
               <br><br>
               üçπProssiga e veja nossos Pacotes.üçπ`;
              classesEstilo = 'border-indigo-500 bg-indigo-50 text-indigo-800';
              canProceed = true; // Permite prosseguir para ver pacotes/servi√ßos
            } else if (cidade === 'an√°polis' && estado === 'GO') {
              // REGRA 2: An√°polis (cidade inteira) - FRETE GR√ÅTIS
              mensagem = `ü•≥ **Atendemos essa regi√£o**! Voc√™ pode ser eleg√≠vel para **frete gr√°tis**
               na sua primeira compra. 
               <br><br>
               üçπProssiga para ver nossos Servi√ßos.üçπ`;
              classesEstilo = 'border-green-500 bg-green-50 text-green-800';
              canProceed = true;
            } else {
              // REGRA 3: Qualquer outra cidade/estado (fora da √°rea principal)
              mensagem = `üòî Desculpa! N√£o atendemos a cidade de ${dadosApi.localidade} (${estado}) no momento. Mas fique √† vontade para olhar nosso site e um dia saborear nossos Drinks aqui em An√°polis-GO.`;
              classesEstilo = 'border-red-500 bg-red-50 text-red-800';
              canProceed = false;
            }

            // 3. Aplica a mensagem e a estiliza√ß√£o
            mensagemResultado.innerHTML = `
                <div class="flex flex-col space-y-2">
                    <p class="text-sm text-gray-700">${enderecoCompleto}</p>
                    <hr class="border-t border-dashed border-current opacity-20"/>
                    <p class="text-base text-current font-bold">${mensagem}</p>
                </div>
            `;
        }

        // Ajusta as classes para garantir um layout melhor na mensagem
        mensagemResultado.className = `mt-8 p-5 min-h-[120px] border-l-4 rounded-lg transition-all duration-500 flex items-center justify-center text-center text-base font-semibold ${classesEstilo}`;

        // 4. Controla a visibilidade do Link "Confirmar"
        if (canProceed) {
          linkConfirmar.classList.remove('hidden');
        } else {
          linkConfirmar.classList.add('hidden');
        }
      }
    </script>
  </body>

</html>






















